<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Tutorials" href="tutorials.html" /><link rel="prev" title="Quick Start" href="quickstart.html" />

    <link rel="shortcut icon" href="_static/favicon.ico"/><!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>Advanced Topics - TenCirChem documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">TenCirChem  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/logov0.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Advanced Topics</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorials.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial_jupyter/ucc_functions.html">UCC Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_jupyter/h2o_pes.html">Potential Energy Surface of the Water Molecule</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_jupyter/adapt_vqe.html">ADAPT VQE</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_jupyter/engine_benchmark.html">Benchmark engines</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_jupyter/hubbard_model.html">Hubbard Model by UCCSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_jupyter/noisy_simulation.html">Noisy Circuit Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_jupyter/sbm_dynamics.html">Dynamics of the Spin-Boson Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_jupyter/marcus.html">Observing Marcus Inverted Region</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_jupyter/vbe_tutorial_groundstate.html">Variational Basis State Encoder (Ground State)</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_jupyter/vbe_tutorial_td.html">Variational Basis State Encoder (Time Dependent)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="modules.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="api/uccsd.html">UCCSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/kupccgsd.html">k-UpCCGSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/puccd.html">Paired UCCD (pUCCD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/ucc.html">UCC</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/hea.html">Headware-Efficient Ansatz and Noisy Circuit Simulation</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/advanced.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="advanced-topics">
<h1>Advanced Topics<a class="headerlink" href="#advanced-topics" title="Link to this heading">¶</a></h1>
<section id="engines">
<h2>Engines<a class="headerlink" href="#engines" title="Link to this heading">¶</a></h2>
<p>TenCirChem offers a set of different engines for the simulation of static molecular properties
and is summarized below.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Engine</p></th>
<th class="head"><p>Compatible class</p></th>
<th class="head"><p>State representation</p></th>
<th class="head"><p>UCC factor expansion</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&quot;civector&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">UCC</span></code></p></td>
<td><p>CI vector</p></td>
<td><p>Yes</p></td>
<td><p>Most efficient</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&quot;civector-large&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">UCC</span></code></p></td>
<td><p>CI vector</p></td>
<td><p>Yes</p></td>
<td><p>Efficient and memory-friendly</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&quot;tensornetwork&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">UCC</span></code>, <code class="docutils literal notranslate"><span class="pre">HEA</span></code></p></td>
<td><p>statevector</p></td>
<td><p>No</p></td>
<td><p>Noiseless tensor network contraction</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&quot;tensornetwork-noise&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">HEA</span></code></p></td>
<td><p>density matrix</p></td>
<td><p>No</p></td>
<td><p>with gate noise</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&quot;tensornetwork-shot&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">HEA</span></code></p></td>
<td><p>statevector</p></td>
<td><p>No</p></td>
<td><p>with measurement noise</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&quot;tensornetwork-noise&amp;shot&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">HEA</span></code></p></td>
<td><p>density matrix</p></td>
<td><p>No</p></td>
<td><p>with gate and measurement noise</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&quot;statevector&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">UCC</span></code></p></td>
<td><p>statevector</p></td>
<td><p>Yes</p></td>
<td><p>Experimental</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&quot;pyscf&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">UCC</span></code></p></td>
<td><p>CI vector</p></td>
<td><p>Yes</p></td>
<td><p>Experimental</p></td>
</tr>
</tbody>
</table>
</div>
<p>“CI vector” means Configuration Interaction vector.
It is a more efficient representation than statevector for chemical applications
because CI vector exploits particle number conservation symmetry.
This is one of the major reasons why TenCirChem is so fast.</p>
<p>“UCC factor expansion” means expanding the excitation operator exponential into a polynomial form</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[e^{\theta G} = I + G^2 - \cos\theta G^2 +\sin \theta G\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(G\)</span> is the excitation operator</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}G = \begin{cases}
    a^\dagger_i a_j - a^\dagger_j a_i , \\
    a^\dagger_i a^\dagger_j a_k a_l - a^\dagger_l a^\dagger_k a_j a_i
    \end{cases}\end{split}\]</div>
</div>
<p>The expansion allows fast simulation of <span class="math notranslate nohighlight">\(e^{\theta G}\)</span>,
without decomposing <span class="math notranslate nohighlight">\(e^{\theta G}\)</span> into quantum gates.
It is not difficult to derive the equation noticing that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[G^3 = - G\]</div>
</div>
<p>In the special case of <span class="math notranslate nohighlight">\(G^2=-I\)</span>, the famous formula <span class="math notranslate nohighlight">\(e^{\theta G}=\cos\theta + \sin\theta G\)</span> is recovered.
The idea was proposed by the
<a class="reference external" href="https://quantum-journal.org/papers/q-2021-10-27-568/">Fermionic Quantum Emulator</a>
based on lots of preceding works.
UCC factor expansion is another major reason why TenCirChem is so fast.</p>
<p>For UCC tasks, <code class="docutils literal notranslate"><span class="pre">&quot;civector&quot;</span></code> engine is most efficient,
however, it is also memory consuming due to cached intermediates.
<code class="docutils literal notranslate"><span class="pre">&quot;civector-large&quot;</span></code> is similar to <code class="docutils literal notranslate"><span class="pre">&quot;civector&quot;</span></code> except that caching is only used in a limited scope.
In general, it is recommended to use the <code class="docutils literal notranslate"><span class="pre">&quot;civector&quot;</span></code> engine until the host/GPU memory runs out,
and then switch to the <code class="docutils literal notranslate"><span class="pre">&quot;civector-large&quot;</span></code> engine.</p>
<p>In the <a class="reference internal" href="api/ucc.html#tencirchem.UCC" title="tencirchem.UCC"><code class="xref py py-class docutils literal notranslate"><span class="pre">UCC</span></code></a> class <code class="docutils literal notranslate"><span class="pre">&quot;civector&quot;</span></code> is the default engine for calculations with &lt;= 16 qubits
and <code class="docutils literal notranslate"><span class="pre">&quot;civector-large&quot;</span></code> is used for larger scale calculation.
In the <a class="reference internal" href="api/hea.html#tencirchem.HEA" title="tencirchem.HEA"><code class="xref py py-class docutils literal notranslate"><span class="pre">HEA</span></code></a> class the noiseless <code class="docutils literal notranslate"><span class="pre">&quot;tensornetwork&quot;</span></code> engine is used by default.</p>
<p>To override the default engine, pass the string to the <code class="docutils literal notranslate"><span class="pre">engine</span></code> argument of the <code class="docutils literal notranslate"><span class="pre">UCC</span></code> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tencirchem</span> <span class="kn">import</span> <span class="n">UCCSD</span>
<span class="kn">from</span> <span class="nn">tencirchem.molecule</span> <span class="kn">import</span> <span class="n">h4</span>
<span class="n">uccsd</span> <span class="o">=</span> <span class="n">UCCSD</span><span class="p">(</span><span class="n">h4</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;civector-large&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">uccsd</span><span class="o">.</span><span class="n">kernel</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">uccsd</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="s2">&quot;tensornetwork&quot;</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="backends">
<h2>Backends<a class="headerlink" href="#backends" title="Link to this heading">¶</a></h2>
<p>TenCirChem supports NumPy, CuPy and JAX backend, in combination with a set of different <a class="reference internal" href="#engines">Engines</a>.
Note that the supported backends differ slightly between TenCirChem and TensorCircuit.</p>
<ul class="simple">
<li><p>To simplify installation, the default backend is NumPy.</p></li>
<li><p>When calculation scales up and GPU is available, CuPy becomes an efficient replacement of NumPy.</p></li>
<li><p>JAX offers auto-differentiation (AD) and just-in-time compilation (JIT) over NumPy and CuPy.
It is the only available backend for the dynamics module.
For static algorithms, JAX is sometimes faster than NumPy and CuPy due to JIT compilation.</p></li>
</ul>
<p>For UCC tasks, TenCirChem typically does not rely on the AD for gradients
and JIT time is usually much longer than the actual run time.
Sometimes JIT will also result in out-of-memory error.
Thus, in general NumPy and CuPy are the recommended backends over JAX.</p>
<p>For noisy circuit simulation, the performance of NumPy and JAX is comparable.
For quantum dynamics simulation, the JAX backend is usually preferred.</p>
<p>TenCirChem shares the same API with TensorCircuit for setting backends and data types, at runtime:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tencirchem</span> <span class="kn">import</span> <span class="n">set_backend</span><span class="p">,</span> <span class="n">set_dtype</span>
<span class="n">set_backend</span><span class="p">(</span><span class="s2">&quot;numpy&quot;</span><span class="p">)</span>
<span class="n">set_dtype</span><span class="p">(</span><span class="s2">&quot;complex64&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>TenCirChem by default uses <code class="docutils literal notranslate"><span class="pre">complex128</span></code> data type, which is different from the TensorCircuit convention.
<code class="docutils literal notranslate"><span class="pre">complex128</span></code> is highly recommended with NumPy backend or <code class="docutils literal notranslate"><span class="pre">float64</span></code>-friendly GPU.</p>
</section>
<section id="boson-encoding">
<h2>Boson Encoding<a class="headerlink" href="#boson-encoding" title="Link to this heading">¶</a></h2>
<p>An important step in quantum dynamics simulation is to map bosons into qubits.
TenCirChem supports 4 different ways to encode boson DOFs into qubits.</p>
<ul class="simple">
<li><p>No encoding. A boson DOF is directly truncated to a two-level system.</p></li>
<li><p>Unary encoding. Use one qubit to represent one boson level.</p></li>
<li><p>Binary encoding. Uses bitstring to represent one boson level.</p></li>
<li><p>Gray code encoding. An improved version of binary encoding.</p></li>
</ul>
<p>A detailed description of the unary encoding and gray encoding, with other variants, can be found in
<a class="reference external" href="https://www.nature.com/articles/s41534-020-0278-0">this article</a> .</p>
<p>In the following table we make a quick comparison of the encodings for a 4-level boson.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Boson level</p></th>
<th class="head"><p>No encoding</p></th>
<th class="head"><p>Unary encoding</p></th>
<th class="head"><p>Binary encoding</p></th>
<th class="head"><p>Gray encoding</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>0</p></td>
<td><p>0001</p></td>
<td><p>00</p></td>
<td><p>00</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>0010</p></td>
<td><p>01</p></td>
<td><p>01</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Truncated</p></td>
<td><p>0100</p></td>
<td><p>10</p></td>
<td><p>11</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Truncated</p></td>
<td><p>1000</p></td>
<td><p>11</p></td>
<td><p>10</p></td>
</tr>
</tbody>
</table>
</div>
<p>Unary encoding costs <span class="math notranslate nohighlight">\(\mathcal{O}(N)\)</span> qubits where <span class="math notranslate nohighlight">\(N\)</span> is boson level,
yet the circuit is shallower.
Gray encoding costs <span class="math notranslate nohighlight">\(\mathcal{O}(\textrm{log}N)\)</span> qubits, yet the circuit depth is deeper.
Gray encoding is strictly better than binary encoding.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">TimeEvolution</span></code> class by default uses Gray code encoding.
Other encodings can be specified through the <code class="docutils literal notranslate"><span class="pre">boson_encoding</span></code> argument of the <code class="docutils literal notranslate"><span class="pre">TimeEvolution</span></code> class.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="tutorials.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Tutorials</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="quickstart.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Quick Start</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, The TenCirChem Authors
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Advanced Topics</a><ul>
<li><a class="reference internal" href="#engines">Engines</a></li>
<li><a class="reference internal" href="#backends">Backends</a></li>
<li><a class="reference internal" href="#boson-encoding">Boson Encoding</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>